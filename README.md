# MOF Social Network Clustering

This repository contains a pipeline for building a social network representation of Metal-Organic Framework (MOF) structures and performing community detection to identify clusters of similar MOFs.

## Overview

Metal-Organic Frameworks (MOFs) are porous materials with diverse applications in gas storage, separations, catalysis, and more. This project implements a graph-based approach to clustering a large dataset of MOF structures based on their geometric, compositional, and other properties.

The approach follows these steps:
1. Data preprocessing and feature normalization
2. Similarity calculation between MOF structures
3. Construction of a network/graph representation 
4. Community detection to identify clusters
5. Analysis and visualization of the results

## Directory Structure

- `Code/`: Python scripts and Jupyter notebooks for the clustering pipeline
  - `mof_social_network.py`: Main script for building the network and detecting communities
  - `mof_cluster_analysis.ipynb`: Jupyter notebook for analyzing the clustering results
  - `run_mof_clustering.sh`: Shell script for easy execution of the pipeline
  - `requirements.txt`: Python package dependencies
  - `README.md`: Detailed instructions for using the code
- `selected data/`: Contains the feature data for the MOF structures
- `test_set_cifs/`, `all_structures_1/`, etc.: Directories containing CIF structure files
- `results/`: (Created during execution) Contains the output files from the clustering pipeline

## Getting Started

### Prerequisites

- Python 3.8 or higher
- Required Python packages (listed in `Code/requirements.txt`)

### Installation

1. Clone this repository
2. Create and activate a virtual environment (optional but recommended):
   ```bash
   python -m venv .venv
   source .venv/bin/activate  # On Windows: .venv\Scripts\activate
   ```
3. Install the required packages:
   ```bash
   pip install -r Code/requirements.txt
   ```

### Usage

You can run the pipeline using the provided shell script:

```bash
cd Code
./run_mof_clustering.sh --help  # Show all options
```

For a quick test with a small sample:

```bash
./run_mof_clustering.sh --sample 5000
```

For a full run with all MOFs:

```bash
./run_mof_clustering.sh
```

### Analyzing Results

After running the pipeline, you can analyze the results using the Jupyter notebook:

```bash
cd Code
jupyter notebook mof_cluster_analysis.ipynb
```

## Key Parameters

- **Similarity Threshold**: Controls how similar two MOFs must be to have an edge between them in the network.
- **Resolution Parameter**: Controls the granularity of the community detection algorithm.

## Computational Considerations

- For the full dataset (~280,000 MOFs), the similarity calculation step requires significant memory (>32GB recommended).
- The script includes batch processing for large datasets to manage memory usage.
- For testing, use the `--sample` parameter to work with a subset of the data.

## Output

The pipeline produces several output files in the specified output directory:
- `mof_communities.csv`: CSV file with MOF identifiers and their assigned community IDs
- `mof_network_visualization.png`: Visualization of the MOF network
- `representative_mofs.csv`: List of representative MOFs from each community (generated by the notebook) 